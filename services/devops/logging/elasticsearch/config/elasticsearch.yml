## Default Elasticsearch configuration from Elasticsearch base image.
## https://github.com/elastic/elasticsearch/blob/master/distribution/docker/src/docker/config/elasticsearch.yml
#
# ---------------------------------- Cluster & Network -----------------------------------
cluster.name: ${ELASTIC_CLUSTER_NAME}
network.host: 0.0.0.0
transport.host: 0.0.0.0
http.port: ${ELASTICSEARCH_PORT}

## Cluster Settings
discovery.seed_hosts: ${ELASTIC_DISCOVERY_SEEDS}
cluster.initial_master_nodes: ${ELASTIC_INIT_MASTER_NODE}

# ---------------------------------- Node -----------------------------------
node.name:    ${ELASTIC_NODE_NAME}
node.roles: ["master", "data", "ingest", "ml", "remote_cluster_client"]

# ---------------------------------- Paths -----------------------------------
path.data: /usr/share/elasticsearch/data
path.logs: /usr/share/elasticsearch/logs
path.repo: ["/usr/share/elasticsearch/backups"]

# ---------------------------------- Memory -----------------------------------
bootstrap.memory_lock: true

# ---------------------------------- License -----------------------------------
xpack.license.self_generated.type: basic


# ---------------------------------- Security -----------------------------------
xpack.security.enabled: true

## - ssl
xpack.security.transport.ssl.enabled: true
xpack.security.transport.ssl.verification_mode: certificate
xpack.security.transport.ssl.key: certs/elasticsearch.key
xpack.security.transport.ssl.certificate: certs/elasticsearch.crt
xpack.security.transport.ssl.certificate_authorities: certs/ca.crt

## - http
xpack.security.http.ssl.enabled: true
xpack.security.http.ssl.key: certs/elasticsearch.key
xpack.security.http.ssl.certificate: certs/elasticsearch.crt
xpack.security.http.ssl.certificate_authorities: certs/ca.crt
xpack.security.http.ssl.client_authentication: optional
http.cors.enabled: true
http.cors.allow-origin: "*"
http.cors.allow-headers: "X-Requested-With,X-Auth-Token,Content-Type,Content-Length,Authorization,Accept,Origin"
http.cors.allow-credentials: true
http.max_content_length: 100mb
http.max_header_size: 8kb
http.max_initial_line_length: 4kb

# ---------------------------------- Various -----------------------------------
action.auto_create_index: "+ft-transcendence-*,+microservices-logs-*,+api-gateway-logs-*,+game-events-*,+chat-messages-*,+security-events-*,+.monitoring-*,+.watches,+.triggered_watches,+.watcher-history-*,+.ml-*,-.security-*"
action.destructive_requires_name: true


# ---------------------------------- Logging -----------------------------------
logger.level: INFO
logger.org.elasticsearch.transport: WARN
logger.org.elasticsearch.discovery: WARN
logger.org.elasticsearch.cluster.service: WARN
logger.org.elasticsearch.indices.recovery: WARN
logger.org.elasticsearch.snapshots: WARN

# ---------------------------------- Monitoring -----------------------------------
xpack.monitoring.collection.enabled: true